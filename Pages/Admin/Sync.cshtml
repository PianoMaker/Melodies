@page
@model SyncModel
@{
    ViewData["Title"] = "Синхронізація БД";
}
<h2>Синхронізація БД</h2>

<form method="post">
    <button class="btn btn-primary">Запустити синхронізацію</button>
</form>

@if (Model.Done)
{
    <p>Синхронізація завершена.</p>
}

@section Scripts {
@if (Model.Collisions?.Count > 0)
{
    <script>
        (() => {
            const msgs = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Collisions));
            const text = 'Колізії:\n' + msgs.map(m => '• ' + m).join('\n');

            let container = document.getElementById('toast-collisions');
            if (!container) {
                container = document.createElement('div');
                container.id = 'toast-collisions';
                container.style.cssText = 'position:fixed;top:1rem;right:1rem;z-index:9999;max-width:420px;font-family:sans-serif';
                document.body.appendChild(container);
            }
            const toast = document.createElement('div');
            toast.style.cssText = 'background:#fff;border:1px solid #d33;border-left:6px solid #d33;color:#222;padding:12px 16px;margin-bottom:8px;box-shadow:0 2px 8px rgba(0,0,0,.25);white-space:pre-wrap';
            toast.textContent = text;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 20000);
        })();
    </script>
}
}