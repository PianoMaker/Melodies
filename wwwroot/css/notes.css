




/* ФОРТЕПІАННА КЛАВІАТУРА */
/* Контейнер для нот */
.notescontainer {
    font-size: 0.8em;
    border: 1px solid gray;
    background-color: lightgoldenrodyellow;
    padding: 8px;
}

    .notescontainer h3 {
        font-size: 1em;
    }

/* Контейнер для пошуку нот */
.notebox {
    display: inline-block;
    font-size: 0.9em;
    text-align: center;
    padding: 2px;
    height: 30px;
    margin: 5px 1px 1px 1px;
    min-width: 35px;
    border: 1px solid gray;
    background-color: antiquewhite;
    border-radius: 5px;
    box-shadow: rgba(55,55,0,0.3) 2px 2px;
}

.pausebox {
    font-size: 1.1em;
    background-color: white;
    border: none;
    background-color: white;
}


/*Кнопки вибору тривалостей для вводу мелодій*/
.durbtn {
    width: 40px;
    height: 40px;
    border: 1px solid black;
    border-radius: 2px;
    margin: 5px;
    transition: background-color 0.3s ease;
}

    .durbtn img {
        height: 30px;
        vertical-align: top;
    }


/* -----------------
    Клавіатура 
    -----------------*/

.piano-scroll-inner {
    box-sizing: border-box;
    text-align: initial;
    position: relative; /* keep normal flow; provides positioning context if needed */
}

#stainway {
    display: block; /* keep full-width container behavior */
    width: 100%;
}

#pianoroll {
    margin: 0 auto; /* center fixed-width piano (800px) inside #stainway */
}

#pianoroll {
    display: block;
    position: relative;
    width: 800px;
    height: 200px;
    font-size: 0;
    overflow: hidden;
}

.piano-scroll-wrapper {
    background-color: var(--surface-400);
    box-shadow: var(--shadow-1);
    margin: 0;
    padding: 0;
}

/* білі клавіші */
.whitepianobutton {
    height: 200px;
    width: 50px;
    margin: 0;
    gap: 0px;
}

/* чорні клавіші */
.blackpianobutton {
    position: absolute;
    width: 40px;
    height: 110px;
    background: linear-gradient(black, darkslategrey);
    margin: 0;
}

/* позиції для кожної чорної клавіші */
.cis1 {
    top: 0px;
    left: 35px;
}

.dis1 {
    top: 0px;
    left: 90px;
}

.fis1 {
    top: 0px;
    left: 180px;
}

.gis1 {
    top: 0px;
    left: 235px;
}

.b1 {
    top: 0px;
    left: 290px;
}

.cis2 {
    top: 0px;
    left: 385px;
}

.dis2 {
    top: 0px;
    left: 440px;
}

.fis2 {
    top: 0px;
    left: 530px;
}

.gis2 {
    top: 0px;
    left: 585px;
}

.b2 {
    top: 0px;
    left: 640px;
}

.dis1 {
    top: 0px;
    left: 90px;
}

.fis1 {
    top: 0px;
    left: 180px;
}

.gis1 {
    top: 0px;
    left: 235px;
}

.b1 {
    top: 0px;
    left: 290px;
}

.cis2 {
    top: 0px;
    left: 385px;
}

.dis2 {
    top: 0px;
    left: 440px;
}

.fis2 {
    top: 0px;
    left: 530px;
}

.gis2 {
    top: 0px;
    left: 585px;
}

.b2 {
    top: 0px;
    left: 640px;
}

/* Transpose controls */
#transpose-controls {
    display: flex;
    justify-content: start;
    align-items: center;
    width: 800px;
    margin-bottom: 20px;
    padding: 5px;
    border: 1px solid black;
    gap: 10px;
    background-color: #f9f9cc;
    border-radius: 8px;
    font-size: 0.8em !important;
}

/* Timesignature styles */
#timesignature .d-flex {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

#timesignature input,
#timesignature select {
    display: inline-block;
    width: 60px; /* or your preferred width */
    margin: 0;
    text-align: center;
    /* Remove any min-width or width: 100% from Bootstrap */
}

#timesignature span {
    display: inline-block;
    width: auto;
    margin: 0 2px;
}


@media (max-width: 900px) {
    .searchcontainer {
        display: block;
    }

    .searchleftcontainer {
        width: 100%;
        padding-left: 0;
        padding-right: 0;
        margin: 0;
        box-sizing: border-box;
    }

    .whitepianobutton {
        width: 45px;
    }

    .blackpianobutton {
        width: 37px;
    }

    .cis1 {
        top: 0px;
        left: 30px;
    }

    .dis1 {
        top: 0px;
        left: 75px;
    }

    .fis1 {
        top: 0px;
        left: 160px;
    }

    .gis1 {
        top: 0px;
        left: 205px;
    }

    .b1 {
        top: 0px;
        left: 252px;
    }

    .cis2 {
        top: 0px;
        left: 340px;
    }

    .dis2 {
        top: 0px;
        left: 390px;
    }

    .fis2 {
        top: 0px;
        left: 480px;
    }

    .gis2 {
        top: 0px;
        left: 525px;
    }

    .b2 {
        top: 0px;
        left: 570px;
    }

    /* ensure right column uses same box model and no stray left offset */
    .notesearchrightcontainer, .searchrightcontainer {
        padding-left: 0;
        padding-right: 0;
        margin: 0;
        box-sizing: border-box;
    }

    /* Enable horizontal scrolling of the keyboard inside the right column
     while keeping the visual keyboard contained by the parent. */
    #stainway {
        overflow-x: auto; /* allow horizontal scroll */
        overflow-y: visible; /* do not clip vertically */
        -webkit-overflow-scrolling: touch; /* smooth scrolling on iOS */
        max-width: 100%;
        height: 200px;
        min-height: 200px;
        /*margin-top: 8px;*/ /* ensure visual separation from any above controls */
    }


    #pianoroll {
        min-width: 800px;
        width: auto;
        height: 200px;
        overflow: visible;
        box-sizing: border-box;
    }

    .whitepianobutton {
        height: 200px;
    }

    .blackpianobutton {
        height: 110px;
    }

    /* Light scrollbar styling (optional, non-invasive) */
    #stainway::-webkit-scrollbar {
        /*height: 8px;*/
    }

    #stainway::-webkit-scrollbar-thumb {
        background: rgba(0,0,0,0.18);
        border-radius: 4px;
    }

    /* Ensure durations panel reserves space and pushes piano down on small screens.
     No z-index used; we rely on normal document flow (margin-bottom) to prevent overlap. */
    #durationspanel {
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
        padding: 8px;
        margin-bottom: 12px; /* critical: push the piano down so it doesn't overlap */
        box-sizing: border-box;
        width: 100%;
    }

    /* If piano is inside a scroll wrapper, add small top spacing so it can't visually collide */
    .piano-scroll-wrapper {
        /*padding-bottom: 6px;*/
        margin-top: 0;
        box-sizing: border-box;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        background-color: var(--surface-400);
    }

        .piano-scroll-wrapper .piano-scroll-inner {
            min-width: 800px; /* keep natural keyboard width */
        }
}

@media (max-width: 768px) {
    .searchcontainer {
        display: block;
    }

    .searchleftcontainer {
        width: 100%;
        padding-left: 0;
        padding-right: 0;
        margin: 0;
    }


    .whitepianobutton {
        width: 45px;
    }

    .blackpianobutton {
        width: 37px;
    }

    .c3 {
        display: none;
    }
}

/* Додати до існуючого файлу */



/* Адаптивне масштабування для нотних блоків */
.melody-block [id^="notation_"] svg {
    display: block;
    width: 100%;
    height: auto;
    max-width: 100%;
}

/* Додати для правильного масштабування на Search сторінці */
.melody-block [id^="notation_match_"] {
    width: 100%;
    max-width: 100%;
}

    .melody-block [id^="notation_match_"] svg {
        display: block;
        width: 100% !important;
        height: auto !important;
        max-width: 100%;
    }

/* Забезпечити правильні розміри контейнера для containerWidth розрахунку */
.melody-block {
    width: 100%;
    box-sizing: border-box;
}

@media (max-width: 800px) {
    .melody-block {
        padding: 8px;
    }

        .melody-block [id^="notation_match_"] {
            /* Переконатися що containerWidth правильно розраховується */
            min-width: 0;
        }
}

/* Контейнер результатів */
#matchedMelodiesContainer {
    max-width: 100%;
    overflow-x: hidden;
}

/* --- Compact controls for mobile (Search page) --- */
/* Keep these rules at the end of notes.css so they override defaults */

@media (max-width: 576px) {
    /* make algorithm radios and melody/rythm checkboxes compact */
    .compact-controls {
        display: flex !important;
        flex-wrap: wrap;
        gap: 8px !important;
        align-items: center !important;
        margin: 0.25rem 0 !important;
    }

        .compact-controls .form-check {
            display: inline-flex !important;
            flex-direction: row !important;
            align-items: center !important;
            gap: 6px !important;
            white-space: nowrap !important;
            min-width: 0 !important; /* allow flex shrinking */
        }

        .compact-controls .form-check-input {
            margin: 0 !important;
            width: 18px !important;
            height: 18px !important;
            flex: 0 0 auto !important;
        }

        .compact-controls .form-check-label {
            display: inline-block !important;
            width: auto !important;
            white-space: nowrap !important;
            margin: 0 !important;
            padding: 0 !important;
            font-size: 0.95rem !important;
        }

        /* Slightly reduce the slider width on mobile when visible */
        .compact-controls .form-range,
        .compact-controls input[type="range"] {
            width: 100px !important;
            margin-left: 6px !important;
            margin-right: 6px !important;
        }

        /* reduce gap between elements that were using gap-3 */
        .compact-controls.gap-3 {
            gap: 8px !important;
        }

    /* ensure hide-mobile keeps hiding on mobile */
    .hide-mobile {
        display: none !important;
    }

    /* minimal spacing for containing right-column controls */
    .notesearchrightcontainer .d-flex.my-2 {
        margin-top: 0.25rem !important;
        margin-bottom: 0.25rem !important;
    }
}

/* Fallback for small tablets */
@media (min-width: 577px) and (max-width: 768px) {
    .compact-controls .form-check-label {
        font-size: 1rem !important;
    }

    .compact-controls .form-check-input {
        width: 19px !important;
        height: 19px !important;
    }
}

/* Piano scroll wrapper: enable horizontal scrolling on narrow screens */
@media (max-width: 900px) {
    .piano-scroll-wrapper {
        width: 100%;
        box-sizing: border-box;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch; /* smooth scrolling on iOS */
        padding-bottom: 6px; /* space for scrollbar */
    }

        /* Ensure inner keyboard keeps its intended layout/width so wrapper scrolls */
        .piano-scroll-wrapper .piano-scroll-inner {
            min-width: 800px; /* matches current piano natural width */
        }

        /* Light scrollbar styling */
        .piano-scroll-wrapper::-webkit-scrollbar {
            height: 8px;
        }

        .piano-scroll-wrapper::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.22);
            border-radius: 4px;
        }

    .piano-scroll-wrapper {
        -ms-overflow-style: auto;
        scrollbar-width: thin;
    }
}

/* use fluid width on narrow screens */
.notesinfo {
    width: 100%;
    padding-left: 12px;
    padding-right: 12px;
    box-sizing: border-box;
    margin: 0;
}
/* Responsive notesinfo: ensure it fits narrow screens */
.notesinfo {
    box-sizing: border-box;
    display: block;
    width: 100%;
    max-width: 100%;
    overflow: hidden;
    border: 1px solid black;
    border-radius: 5px;
    background-color: lightgray;
    padding: 10px 10px;
    margin: 0;
    /*padding: 10px;*/
}

    /* letters / textarea: use full width inside notesinfo */
    .notesinfo #lettersdisplay,
    .notesinfo #lettersdisplay textarea,
    .notesinfo #pianodisplay {
        width: 100% !important;
        max-width: 100%;
        box-sizing: border-box;
    }

    /* button area: flexible, wrap when narrow */
    .notesinfo #buttonarea {
        display: flex !important;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
        width: auto !important; /* override inline width:60% if present */
        box-sizing: border-box;
        margin-top: 6px;
    }

        /* keep buttons compact and prevent overflow */
        .notesinfo #buttonarea .btn-melody {
            flex: 0 0 auto;
            white-space: nowrap;
        }

/* small adjustments for very narrow screens */
@media (max-width: 480px) {
    .notesinfo {
        padding: 6px;
    }

        .notesinfo #buttonarea {
            gap: 4px;
        }

            .notesinfo #buttonarea .btn-melody {
                font-size: 0.95rem;
                padding: 6px 8px;
            }
        /* ensure textarea rows remain usable */
        .notesinfo #pianodisplay {
            height: auto;
            min-height: 44px;
        }
}

/* Duration panel on Search page */
#durationspanel {
    display: flex;
    box-sizing: border-box;
    flex-direction: row;
    gap: 24px;
    flex-wrap: nowrap;
    margin-right: 10px;
    width: 100%;
    padding-left: 8px;
    margin-left: 0;
    overflow: visible;
}

#durationbuttons {
    display: flex;
    flex-direction: row;
    gap: 8px;
    flex: 1 1 0%;
    min-width: 0;
    flex-wrap: wrap;
    align-items: center;
}


#timesignature {
    display: flex;
    flex-direction: column;
    justify-content: center;
}

@media (max-width: 900px) {
    #durationspanel {
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
    }
}

.settimesignature {
    display: flex !important;
    flex-direction: row !important;
    align-items: center;
    gap: 0.5rem;
}

    .settimesignature input,
    .settimesignature select,
    .settimesignature span {
        display: inline-block !important;
        width: auto;
        margin: 0 2px;
        vertical-align: middle;
        box-sizing: border-box;
    }

/*  ВИПРАВЛЕННЯ ПОЗИЦІЙ КЛАВІАТУРИ ДЛЯ ШИРОКИХ ЕКРАНІВ */

@media (min-width: 901px) {
    /* center piano without changing positioning context inside it */
    .piano-scroll-inner {
        text-align: center;
    }

    .blackpianobutton {
        transform: translateX(20px);
        /* preserve existing stacking and positioning */
        will-change: transform;
    }


    #pianoroll {
        display: block; /* restore block layout */
        margin: 0 auto; /* center fixed-width piano */
        width: 800px; /* keep explicit width */
        position: relative; /* keep absolute positioning context for black keys */
        box-sizing: border-box;
        font-size: 0; /* avoid inline whitespace effects inside piano */
    }

        /* ensure white keys use stable inline-block layout and align to top */
        #pianoroll .whitepianobutton {
            display: inline-block;
            vertical-align: top;
        }


}
